From 7a9ec10b911133897ce959700e22b49a7c519f0c Mon Sep 17 00:00:00 2001
Message-Id: <7a9ec10b911133897ce959700e22b49a7c519f0c.1645092977.git.maciej.zenon.borzecki@canonical.com>
From: Maciej Borzecki <maciej.zenon.borzecki@canonical.com>
Date: Wed, 2 Feb 2022 13:20:04 +0100
Subject: [PATCH] data/selinux: snap-confine may getattr device nodes when
 setting up /dev in the snap namespace

Signed-off-by: Maciej Borzecki <maciej.zenon.borzecki@canonical.com>
---
 data/selinux/snappy.te | 1 +
 1 file changed, 1 insertion(+)

diff --git a/data/selinux/snappy.te b/data/selinux/snappy.te
index cae01cd2256500caa6b82a56b10ada0093400f03..11d7afe4ec14618fcadbc10fbfe21151cf0d7ae7 100644
--- a/data/selinux/snappy.te
+++ b/data/selinux/snappy.te
@@ -631,6 +631,7 @@ dev_getattr_fs(snappy_confine_t)
 dev_getattr_sysfs_fs(snappy_confine_t)
 dev_list_sysfs(snappy_confine_t)
 dev_read_sysfs(snappy_confine_t)
+dev_getattr_all(snappy_confine_t)
 fs_getattr_cgroup(snappy_confine_t)
 fs_getattr_hugetlbfs(snappy_confine_t)
 fs_getattr_tmpfs(snappy_confine_t)
-- 
2.35.1

